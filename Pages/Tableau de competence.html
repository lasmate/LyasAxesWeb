<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Axing of Lya</title>
    <link href="../style/newstyle.css" rel="stylesheet" type="text/css" media="all">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Genos">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono">
    <link rel="icon" href="../img/TraFavicon.png" type="image/x-icon">

  </head>  

<body>

<div class="page-container" style="height: 100vh; overflow: hidden;">
  <div class="content-wrapper" style="height: 100vh;">
  <div class="flex-container">
    <div class="flex-nav"> <span data-i18n="nav.home" onclick="location.href='../index.html'">Home</span></div>
    <div class="flex-nav">
      <span data-i18n="nav.products">My Productions</span>
      <div class="flex-nav"> <span data-i18n="nav.programming" onclick="location.href='CodePort.html'">Programming </span></div>
      <div class="flex-nav"> <span data-i18n="nav.3d" onclick="location.href='Pages/3DPort.html'">3D Modeling </span></div>
    </div>
    <div class="flex-nav"> <span data-i18n="nav.journal" onclick="location.href='JournalPort.html'">Journal</span></div>
    <div class="flex-nav"> <span data-i18n="nav.table" onclick="location.href='Tableau de competence.html'">Skills <br> Table</span></div>
  </div>

    <div class="site-content" style="padding: 20px;">
  <h1 data-i18n="tableau.h1">Tableau de Competences BTS SIO</h1>
  <p id="intro" data-i18n-html="tableau.intro">
      Voici le tableau de compétences que j'ai pu remplir à ce jour, il est automatiquement mis à jour par la fonction publish de Google Sheets et contient les projets réalisés au cours de formation ainsi que dans le cadre de mes stages.
      <br><br>
  </p>
  <div id="zoom-control" aria-label="Sheet zoom controls" title="Zoom">
    <button id="zc-decr" class="zc-btn" data-i18n="tableau.zoom.decr">-</button>
    <button id="zc-reset" class="zc-btn" data-i18n="tableau.zoom.reset">/</button>
    <button id="zc-incr" class="zc-btn" data-i18n="tableau.zoom.incr">+</button>
  </div>
      <article>
        <!-- Responsive wrapper: keeps the visible area at 80vh and scales the embedded sheet so it never requires horizontal scrolling -->
        <div id="sheet-wrap" style="width:100%;height:80vh;overflow:hidden;">
          <iframe id="sheet-iframe"
                  data-natural-width="1600"
                  src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTKqzH9C4AMlFXOvPWDSghYsDz7rRk4oEvNG6n5F5-fb438q2XZUvxEsEcTX8hSeKd22O7B8rb3ER4B/pubhtml?gid=2094214806&amp;single=true&amp;widget=true&amp;headers=false"
                  frameborder="0"
                  scrolling="yes"
                  style="border:0; display:block; transform-origin:0 0; -webkit-transform-origin:0 0;">
          </iframe>
        </div>
        <style>
          /* Allow page to behave normally vertically but prevent horizontal overflow */
          html, body { width:100%; height:100%; margin:0; padding:0; overflow-x:hidden; }
          .flex-container, .site-content { box-sizing:border-box; }
          #sheet-wrap { overflow:hidden; }
          #sheet-iframe { display:block; border:0; }
        </style>

        <script>
          (function(){
            const iframe = document.getElementById('sheet-iframe');
            const wrap = document.getElementById('sheet-wrap');
            const naturalWidth = parseInt(iframe.getAttribute('data-natural-width')) || 1600;

            // user-controlled zoom multiplier (1 = fit-to-width)
            let userZoom = 1;
            const ZOOM_STEP = 1.1; // multiply/divide by this
            const ZOOM_MIN = 0.2;
            const ZOOM_MAX = 4;

            function resize(){
              const containerW = wrap.clientWidth;
              const containerH = wrap.clientHeight;
              // base scale so the iframe content width fits the container
              let baseScale = containerW / naturalWidth;
              // avoid scaling up beyond 1 (prevents pixelation)
              baseScale = Math.min(baseScale, 1);

              const combinedScale = Math.max(baseScale * userZoom, 0.0001);

              // set iframe intrinsic size (unscaled)
              iframe.style.width = naturalWidth + 'px';
              // set height so that after scaling it fills the wrapper (visible height = iframeHeight * combinedScale)
              const neededIframeH = Math.ceil(containerH / combinedScale);
              iframe.style.height = neededIframeH + 'px';

              // apply scale transform
              iframe.style.transform = 'scale(' + combinedScale + ')';
              iframe.style.webkitTransform = 'scale(' + combinedScale + ')';
            }

            // zoom control helpers
            function setUserZoom(z){
              userZoom = Math.max(ZOOM_MIN, Math.min(ZOOM_MAX, z));
              resize();
            }
            function zoomIn(){ setUserZoom(userZoom * ZOOM_STEP); }
            function zoomOut(){ setUserZoom(userZoom / ZOOM_STEP); }
            function zoomReset(){ setUserZoom(1); }

            // wire buttons
            const btnDecr = document.getElementById('zc-decr');
            const btnReset = document.getElementById('zc-reset');
            const btnIncr = document.getElementById('zc-incr');
            if(btnDecr) btnDecr.addEventListener('click', zoomOut);
            if(btnReset) btnReset.addEventListener('click', zoomReset);
            if(btnIncr) btnIncr.addEventListener('click', zoomIn);

            // Run on load and resize
            window.addEventListener('resize', resize);
            window.addEventListener('orientationchange', resize);
        // ensure initial sizing after everything loads
          window.addEventListener('load', function(){ setTimeout(resize, 50); });
          })();
        </script>

      </article>
    </div>
  </div>
</div>
    <script src="../scripts/translations.js"></script>
    <script src="../scripts/i18n.js" defer></script>
    </body>
    </html>

